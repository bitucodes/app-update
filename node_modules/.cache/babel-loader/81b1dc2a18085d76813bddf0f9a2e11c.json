{"ast":null,"code":"/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\"use strict\";\n\nvar _classCallCheck = require(\"/home/lenovo/Desktop/chatapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/classCallCheck\");\nvar _createClass = require(\"/home/lenovo/Desktop/chatapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/createClass\");\nvar AliasPlugin = require(\"enhanced-resolve/lib/AliasPlugin\");\nvar ParserHelpers = require(\"../ParserHelpers\");\nvar nodeLibsBrowser = require(\"node-libs-browser\");\nmodule.exports = /*#__PURE__*/function () {\n  function NodeSourcePlugin(options) {\n    _classCallCheck(this, NodeSourcePlugin);\n    this.options = options;\n  }\n  _createClass(NodeSourcePlugin, [{\n    key: \"apply\",\n    value: function apply(compiler) {\n      var options = this.options;\n      if (options === false) {\n        // allow single kill switch to turn off this plugin\n        return;\n      }\n      var getPathToModule = function getPathToModule(module, type) {\n        if (type === true || type === undefined && nodeLibsBrowser[module]) {\n          if (!nodeLibsBrowser[module]) {\n            throw new Error(\"No browser version for node.js core module \".concat(module, \" available\"));\n          }\n          return nodeLibsBrowser[module];\n        } else if (type === \"mock\") {\n          return require.resolve(\"node-libs-browser/mock/\".concat(module));\n        } else if (type === \"empty\") {\n          return require.resolve(\"node-libs-browser/mock/empty\");\n        } else {\n          return module;\n        }\n      };\n      var addExpression = function addExpression(parser, name, module, type, suffix) {\n        suffix = suffix || \"\";\n        parser.hooks.expression.for(name).tap(\"NodeSourcePlugin\", function () {\n          if (parser.state.module && parser.state.module.resource === getPathToModule(module, type)) return;\n          var mockModule = ParserHelpers.requireFileAsExpression(parser.state.module.context, getPathToModule(module, type));\n          return ParserHelpers.addParsedVariableToModule(parser, name, mockModule + suffix);\n        });\n      };\n      compiler.hooks.compilation.tap(\"NodeSourcePlugin\", function (compilation, _ref) {\n        var normalModuleFactory = _ref.normalModuleFactory;\n        var handler = function handler(parser, parserOptions) {\n          if (parserOptions.node === false) return;\n          var localOptions = options;\n          if (parserOptions.node) {\n            localOptions = Object.assign({}, localOptions, parserOptions.node);\n          }\n          if (localOptions.global) {\n            parser.hooks.expression.for(\"global\").tap(\"NodeSourcePlugin\", function () {\n              var retrieveGlobalModule = ParserHelpers.requireFileAsExpression(parser.state.module.context, require.resolve(\"../../buildin/global\"));\n              return ParserHelpers.addParsedVariableToModule(parser, \"global\", retrieveGlobalModule);\n            });\n          }\n          if (localOptions.process) {\n            var processType = localOptions.process;\n            addExpression(parser, \"process\", \"process\", processType);\n          }\n          if (localOptions.console) {\n            var consoleType = localOptions.console;\n            addExpression(parser, \"console\", \"console\", consoleType);\n          }\n          var bufferType = localOptions.Buffer;\n          if (bufferType) {\n            addExpression(parser, \"Buffer\", \"buffer\", bufferType, \".Buffer\");\n          }\n          if (localOptions.setImmediate) {\n            var setImmediateType = localOptions.setImmediate;\n            addExpression(parser, \"setImmediate\", \"timers\", setImmediateType, \".setImmediate\");\n            addExpression(parser, \"clearImmediate\", \"timers\", setImmediateType, \".clearImmediate\");\n          }\n        };\n        normalModuleFactory.hooks.parser.for(\"javascript/auto\").tap(\"NodeSourcePlugin\", handler);\n        normalModuleFactory.hooks.parser.for(\"javascript/dynamic\").tap(\"NodeSourcePlugin\", handler);\n        normalModuleFactory.hooks.parser.for(\"javascript/esm\").tap(\"NodeSourcePlugin\", handler);\n      });\n      compiler.hooks.afterResolvers.tap(\"NodeSourcePlugin\", function (compiler) {\n        var _loop = function _loop() {\n          var lib = _Object$keys[_i];\n          if (options[lib] !== false) {\n            compiler.resolverFactory.hooks.resolver.for(\"normal\").tap(\"NodeSourcePlugin\", function (resolver) {\n              new AliasPlugin(\"described-resolve\", {\n                name: lib,\n                onlyModule: true,\n                alias: getPathToModule(lib, options[lib])\n              }, \"resolve\").apply(resolver);\n            });\n          }\n        };\n        for (var _i = 0, _Object$keys = Object.keys(nodeLibsBrowser); _i < _Object$keys.length; _i++) {\n          _loop();\n        }\n      });\n    }\n  }]);\n  return NodeSourcePlugin;\n}();","map":null,"metadata":{},"sourceType":"script"}