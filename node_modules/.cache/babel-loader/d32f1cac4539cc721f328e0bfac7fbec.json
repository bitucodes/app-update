{"ast":null,"code":"var Readable = require('readable-stream').Readable;\nvar inherits = require('inherits');\nmodule.exports = from2;\nfrom2.ctor = ctor;\nfrom2.obj = obj;\nvar Proto = ctor();\nfunction toFunction(list) {\n  list = list.slice();\n  return function (_, cb) {\n    var err = null;\n    var item = list.length ? list.shift() : null;\n    if (item instanceof Error) {\n      err = item;\n      item = null;\n    }\n    cb(err, item);\n  };\n}\nfunction from2(opts, read) {\n  if (typeof opts !== 'object' || Array.isArray(opts)) {\n    read = opts;\n    opts = {};\n  }\n  var rs = new Proto(opts);\n  rs._from = Array.isArray(read) ? toFunction(read) : read || noop;\n  return rs;\n}\nfunction ctor(opts, read) {\n  if (typeof opts === 'function') {\n    read = opts;\n    opts = {};\n  }\n  opts = defaults(opts);\n  inherits(Class, Readable);\n  function Class(override) {\n    if (!(this instanceof Class)) return new Class(override);\n    this._reading = false;\n    this._callback = check;\n    this.destroyed = false;\n    Readable.call(this, override || opts);\n    var self = this;\n    var hwm = this._readableState.highWaterMark;\n    function check(err, data) {\n      if (self.destroyed) return;\n      if (err) return self.destroy(err);\n      if (data === null) return self.push(null);\n      self._reading = false;\n      if (self.push(data)) self._read(hwm);\n    }\n  }\n  Class.prototype._from = read || noop;\n  Class.prototype._read = function (size) {\n    if (this._reading || this.destroyed) return;\n    this._reading = true;\n    this._from(size, this._callback);\n  };\n  Class.prototype.destroy = function (err) {\n    if (this.destroyed) return;\n    this.destroyed = true;\n    var self = this;\n    process.nextTick(function () {\n      if (err) self.emit('error', err);\n      self.emit('close');\n    });\n  };\n  return Class;\n}\nfunction obj(opts, read) {\n  if (typeof opts === 'function' || Array.isArray(opts)) {\n    read = opts;\n    opts = {};\n  }\n  opts = defaults(opts);\n  opts.objectMode = true;\n  opts.highWaterMark = 16;\n  return from2(opts, read);\n}\nfunction noop() {}\nfunction defaults(opts) {\n  opts = opts || {};\n  return opts;\n}","map":null,"metadata":{},"sourceType":"script"}