{"ast":null,"code":"var override = require('../utils/override');\nvar INTEGER_PATTERN = /^\\d+$/;\nvar ALL_UNITS = ['*', 'all'];\nvar DEFAULT_PRECISION = 'off'; // all precision changes are disabled\nvar DIRECTIVES_SEPARATOR = ','; // e.g. *=5,px=3\nvar DIRECTIVE_VALUE_SEPARATOR = '='; // e.g. *=5\n\nfunction roundingPrecisionFrom(source) {\n  return override(defaults(DEFAULT_PRECISION), buildPrecisionFrom(source));\n}\nfunction defaults(value) {\n  return {\n    'ch': value,\n    'cm': value,\n    'em': value,\n    'ex': value,\n    'in': value,\n    'mm': value,\n    'pc': value,\n    'pt': value,\n    'px': value,\n    'q': value,\n    'rem': value,\n    'vh': value,\n    'vmax': value,\n    'vmin': value,\n    'vw': value,\n    '%': value\n  };\n}\nfunction buildPrecisionFrom(source) {\n  if (source === null || source === undefined) {\n    return {};\n  }\n  if (typeof source == 'boolean') {\n    return {};\n  }\n  if (typeof source == 'number' && source == -1) {\n    return defaults(DEFAULT_PRECISION);\n  }\n  if (typeof source == 'number') {\n    return defaults(source);\n  }\n  if (typeof source == 'string' && INTEGER_PATTERN.test(source)) {\n    return defaults(parseInt(source));\n  }\n  if (typeof source == 'string' && source == DEFAULT_PRECISION) {\n    return defaults(DEFAULT_PRECISION);\n  }\n  if (typeof source == 'object') {\n    return source;\n  }\n  return source.split(DIRECTIVES_SEPARATOR).reduce(function (accumulator, directive) {\n    var directiveParts = directive.split(DIRECTIVE_VALUE_SEPARATOR);\n    var name = directiveParts[0];\n    var value = parseInt(directiveParts[1]);\n    if (isNaN(value) || value == -1) {\n      value = DEFAULT_PRECISION;\n    }\n    if (ALL_UNITS.indexOf(name) > -1) {\n      accumulator = override(accumulator, defaults(value));\n    } else {\n      accumulator[name] = value;\n    }\n    return accumulator;\n  }, {});\n}\nmodule.exports = {\n  DEFAULT: DEFAULT_PRECISION,\n  roundingPrecisionFrom: roundingPrecisionFrom\n};","map":null,"metadata":{},"sourceType":"script"}