{"ast":null,"code":"'use strict';\n\nvar BB = require('bluebird');\nvar fixOwner = require('./fix-owner');\nvar path = require('path');\nvar rimraf = BB.promisify(require('rimraf'));\nvar uniqueFilename = require('unique-filename');\nmodule.exports.mkdir = mktmpdir;\nfunction mktmpdir(cache, opts) {\n  opts = opts || {};\n  var tmpTarget = uniqueFilename(path.join(cache, 'tmp'), opts.tmpPrefix);\n  return fixOwner.mkdirfix(tmpTarget, opts.uid, opts.gid).then(function () {\n    return tmpTarget;\n  });\n}\nmodule.exports.withTmp = withTmp;\nfunction withTmp(cache, opts, cb) {\n  if (!cb) {\n    cb = opts;\n    opts = null;\n  }\n  opts = opts || {};\n  return BB.using(mktmpdir(cache, opts).disposer(rimraf), cb);\n}\nmodule.exports.fix = fixtmpdir;\nfunction fixtmpdir(cache, opts) {\n  return fixOwner(path.join(cache, 'tmp'), opts.uid, opts.gid);\n}","map":null,"metadata":{},"sourceType":"script"}